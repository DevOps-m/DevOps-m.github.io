<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>流转千回</title>
  
  <subtitle>技术成长之路</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://devops-m.github.io/"/>
  <updated>2019-09-24T06:26:32.355Z</updated>
  <id>https://devops-m.github.io/</id>
  
  <author>
    <name>李志强</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>使用autofs自动挂载NFS网络文件系统</title>
    <link href="https://devops-m.github.io/2019/09/23/shi-yong-autofs-zi-dong-gua-zai-nfs-wang-luo-wen-jian-xi-tong/"/>
    <id>https://devops-m.github.io/2019/09/23/shi-yong-autofs-zi-dong-gua-zai-nfs-wang-luo-wen-jian-xi-tong/</id>
    <published>2019-09-23T07:13:00.000Z</published>
    <updated>2019-09-24T06:26:32.355Z</updated>
    
    <content type="html"><![CDATA[<h3 id="系统信息："><a href="#系统信息：" class="headerlink" title="系统信息："></a>系统信息：</h3><table><thead><tr><th>系统版本</th><th>内核版本</th><th>NFS版本</th></tr></thead><tbody><tr><td>CentOS Linux release 7.6.1810 (Core)</td><td>3.10.0-957.el7.x86_64</td><td>1.3.0</td></tr></tbody></table><blockquote><p>PS：这里不介绍部署NFS网络共享文件系统内容。</p></blockquote><h3 id="部署过程："><a href="#部署过程：" class="headerlink" title="部署过程："></a>部署过程：</h3><blockquote><p>参考文献：<a href="https://blog.csdn.net/qq_20327293/article/details/51568077" target="_blank" rel="noopener">https://blog.csdn.net/qq_20327293/article/details/51568077</a></p></blockquote><h4 id="1-安装autofs软件："><a href="#1-安装autofs软件：" class="headerlink" title="1. 安装autofs软件："></a>1. 安装autofs软件：</h4><pre><code>root@linux:~# yum install -y autofs</code></pre><h4 id="2-添加配置，在-etc-auto-master内增加内容："><a href="#2-添加配置，在-etc-auto-master内增加内容：" class="headerlink" title="2. 添加配置，在/etc/auto.master内增加内容："></a>2. 添加配置，在/etc/auto.master内增加内容：</h4><pre><code>root@linux:~# echo &quot;/mnt /etc/auto.nfs&quot; &gt;&gt; /etc/auto.master</code></pre><blockquote><p>PS：”/mnt”为挂载点一级目录，”/etc/auto.nfs”为引用这文件，具体设置根据环境来定，其中如果想要挂载点为”/mnt”，那么这里就需要设置为”/“，二级挂载点设置为”mnt”，合起来就是”/mnt”，但是这种方式会有失败。</p></blockquote><h4 id="3-创建-etc-auto-nfs："><a href="#3-创建-etc-auto-nfs：" class="headerlink" title="3. 创建/etc/auto.nfs："></a>3. 创建/etc/auto.nfs：</h4><pre><code>root@linux:~# echo &quot;renderdata -fstype=nfs,vers=4,minorversion=0,noatime,nodiratime,nosuid,noexec,nodev,ro,bg,soft,_netdev nfs.linux.com:/data/renderdata&quot; &gt; /etc/auto.nfs</code></pre><blockquote><p>PS：”renderdata”为挂载点二级目录，也就是实际挂载点目录为”/mnt/renderdata”，其中二级挂载点目录不需要在系统上存在，访问挂载点的时候会自动创建，后面的选项则分别为挂载参数和NFS服务端共享地址。</p></blockquote><h4 id="4-将autofs服务设置开机自启并启动："><a href="#4-将autofs服务设置开机自启并启动：" class="headerlink" title="4. 将autofs服务设置开机自启并启动："></a>4. 将autofs服务设置开机自启并启动：</h4><pre><code>root@linux:~# systemctl enable autofs.serviceroot@linux:~# systemctl start autofs.serviceroot@linux:~# systemctl status autofs.service</code></pre><h4 id="5-测试autofs部署情况："><a href="#5-测试autofs部署情况：" class="headerlink" title="5. 测试autofs部署情况："></a>5. 测试autofs部署情况：</h4><pre><code>ops@linux:~$ df -hFilesystem                          Size  Used Avail Use% Mounted on/dev/mapper/vg01-root               200G  4.0G  196G   2% /devtmpfs                             63G     0   63G   0% /devtmpfs                                63G     0   63G   0% /dev/shmtmpfs                                63G   11M   63G   1% /runtmpfs                                63G     0   63G   0% /sys/fs/cgroup/dev/sda2                           497M  132M  365M  27% /boot/dev/sda1                           500M   12M  489M   3% /boot/efi/dev/mapper/vg01-data               3.1T   38M  3.1T   1% /datatmpfs                                13G     0   13G   0% /run/user/1000ops@linux:~$</code></pre><pre><code>ops@linux:~$ tree -L 1 /mnt//mnt/0 directories, 0 filesops@linux:~$ ops@linux:~$ ls /mnt/renderdataexportgeometry  modelvrscene  renderingvrscene  scriptsops@linux:~$ ops@linux:~$ tree -L 1 /mnt//mnt/└── renderdata1 directory, 0 filesops@linux:~$ </code></pre><pre><code>ops@linux:~$ df -hFilesystem                          Size  Used Avail Use% Mounted on/dev/mapper/vg01-root               200G  4.0G  196G   2% /devtmpfs                             63G     0   63G   0% /devtmpfs                                63G     0   63G   0% /dev/shmtmpfs                                63G   11M   63G   1% /runtmpfs                                63G     0   63G   0% /sys/fs/cgroup/dev/sda2                           497M  132M  365M  27% /boot/dev/sda1                           500M   12M  489M   3% /boot/efi/dev/mapper/vg01-data               3.1T   38M  3.1T   1% /datatmpfs                                13G     0   13G   0% /run/user/1000nfs.linux.com:/data/renderdata      4.0T  1.2T  2.9T  29% /mnt/renderdataops@linux:~$</code></pre><blockquote><p>PS：可以看到测试过程如上所示。</p></blockquote>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;系统信息：&quot;&gt;&lt;a href=&quot;#系统信息：&quot; class=&quot;headerlink&quot; title=&quot;系统信息：&quot;&gt;&lt;/a&gt;系统信息：&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;系统版本&lt;/th&gt;
&lt;th&gt;内核版本&lt;/th&gt;
&lt;th&gt;NFS版本&lt;/t
      
    
    </summary>
    
      <category term="Linux" scheme="https://devops-m.github.io/categories/Linux/"/>
    
    
      <category term="Linux" scheme="https://devops-m.github.io/tags/Linux/"/>
    
  </entry>
  
</feed>
